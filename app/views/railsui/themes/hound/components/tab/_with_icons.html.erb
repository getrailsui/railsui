<div id="tab-with-icons">
  <%= render layout: example, locals: { heading: "With icons", section: "Tab" } do %>

    <%= render preview 'gray' do %>
      <div
  data-controller="railsui-tabs"
  data-railsui-tabs-active-tab="py-3 px-4 border-b border-primary-500 flex items-center space-x-3 whitespace-nowrap text-primary-600 dark:text-primary-400 dark:border-primary-400 rounded-t"
  data-railsui-tabs-inactive-tab="py-3 px-4 flex items-center space-x-3 whitespace-nowrap border-b dark:border-slate-600">
        <div class="border-slate-200 border-b text-slate-600 dark:text-slate-200 dark:border-slate-600 text-sm font-medium">
          <nav role="navigation" class="-mb-px flex items-center flex-wrap">
            <a href="#" data-railsui-tabs-target="tab" data-action="click->railsui-tabs#change"
              class="py-3 px-4 border-b border-primary-500 flex items-center space-x-3 whitespace-nowrap text-primary-600 dark:text-primary-400 dark:border-primary-400 rounded-t">
              <%= icon "chat-bubble-oval-left-ellipsis", classes: "w-5 h-5" %>
              <span>Activity</span>
            </a>
            <a href="#" data-railsui-tabs-target="tab" data-action="click->railsui-tabs#change" class="py-3 px-4 flex items-center space-x-3 whitespace-nowrap border-b bg-transparent dark:bg-transparent dark:border-slate-600">
              <%= icon "user-circle", classes: "w-5 h-5" %>
              <span>Account</span>
            </a>
            <a href="#" data-railsui-tabs-target="tab" data-action="click->railsui-tabs#change" class="py-3 px-4 flex items-center space-x-3 whitespace-nowrap border-b bg-transparent dark:bg-transparent dark:border-slate-600">
              <%= icon "credit-card", classes: "w-5 h-5" %>
              <span>Billing</span>
            </a>
            <a href="#" data-railsui-tabs-target="tab" data-action="click->railsui-tabs#change" class="py-3 px-4 flex items-center space-x-3 whitespace-nowrap border-b bg-transparent dark:bg-transparent dark:border-slate-600">
              <%= icon "users", classes: "w-5 h-5" %>
              <span>Team</span>
            </a>
          </nav>
        </div>
        <div class="p-4" data-railsui-tabs-target="panel">
          Some activities...
        </div>

        <div class="hidden p-4" data-railsui-tabs-target="panel">
          Account information...
        </div>

        <div class="hidden p-4" data-railsui-tabs-target="panel">
          Billing information...
        </div>
        <div class="hidden p-4" data-railsui-tabs-target="panel">
          Team information...
        </div>
      </div>
    <% end %>

    <% content_for :example, flush: true do %>
      <% content_for :html, flush: true do %>
<div
data-controller="tabs"
data-tabs-active-tab="py-3 px-4 border-b border-primary-500 flex items-center space-x-3 whitespace-nowrap text-primary-600 dark:text-primary-400 dark:border-primary-400 rounded-t"
data-tabs-inactive-tab="py-3 px-4 flex items-center space-x-3 whitespace-nowrap border-b dark:border-slate-600">

  <div class="border-slate-200 border-b text-slate-600 dark:text-slate-200 dark:border-slate-600 text-sm font-medium">
    <nav role="navigation" class="-mb-px flex items-center flex-wrap">
      <a href="#"
data-tabs-target="tab" data-action="click->tabs#change"
        class="py-3 px-4 border-b border-primary-500 flex items-center space-x-3 whitespace-nowrap text-primary-600 dark:text-primary-400 dark:border-primary-400 rounded-t">
        <%%= icon "chat-bubble-oval-left-ellipsis", classes: "w-5 h-5" %>
        <span>Activity</span>
      </a>
      <a href="#" data-tabs-target="tab" data-action="click->tabs#change" class="py-3 px-4 flex items-center space-x-3 whitespace-nowrap border-b bg-transparent dark:bg-transparent dark:border-slate-600">
        <%%= icon "user-circle", classes: "w-5 h-5" %>
        <span>Account</span>
      </a>
      <a href="#" data-tabs-target="tab" data-action="click->tabs#change" class="py-3 px-4 flex items-center space-x-3 whitespace-nowrap border-b bg-transparent dark:bg-transparent dark:border-slate-600">
        <%%= icon "credit-card", classes: "w-5 h-5" %>
        <span>Billing</span>
      </a>
      <a href="#" data-tabs-target="tab" data-action="click->tabs#change" class="py-3 px-4 flex items-center space-x-3 whitespace-nowrap border-b bg-transparent dark:bg-transparent dark:border-slate-600">
        <%%= icon "users", classes: "w-5 h-5" %>
        <span>Team</span>
      </a>
    </nav>
  </div>
  <div class="p-4" data-tabs-target="panel">
    Some activities...
  </div>

  <div class="hidden p-4" data-tabs-target="panel">
    Account information...
  </div>

  <div class="hidden p-4" data-tabs-target="panel">
    Billing information...
  </div>
  <div class="hidden p-4" data-tabs-target="panel">
    Team information...
  </div>
</div>
<% end %>

<% content_for :erb, flush: true do %>
<div
data-controller="tabs"
data-tabs-active-tab="py-3 px-4 border-b border-primary-500 flex items-center space-x-3 whitespace-nowrap text-primary-600 dark:text-primary-400 dark:border-primary-400 rounded-t"
data-tabs-inactive-tab="py-3 px-4 flex items-center space-x-3 whitespace-nowrap border-b dark:border-slate-600">
  <div class="border-slate-200 border-b text-slate-600 dark:text-slate-200 dark:border-slate-600 text-sm font-medium">
    <nav role="navigation" class="-mb-px flex items-center flex-wrap">
      <%%= link_to "#", class: "py-3 px-4 border-b border-primary-500 flex items-center space-x-3 whitespace-nowrap text-primary-600 dark:text-primary-400 dark:border-primary-400 rounded-t", data: { tabs_target: "tab", action: "click->tabs#change" } do %>
        <%%= icon "chat-bubble-oval-left-ellipsis", classes: "w-5 h-5" %>
        <span>Activity</span>
      <%% end %>
      <%%= link_to "#", class: "py-3 px-4 flex items-center space-x-3 whitespace-nowrap border-b bg-transparent dark:bg-transparent dark:border-slate-600", data: { tabs_target: "tab", action: "click->tabs#change" } do %>
        <%%= icon "user-circle", classes: "w-5 h-5" %>
        <span>Account</span>
      <%% end %>
      <%%= link_to "#", class: "py-3 px-4 flex items-center space-x-3 whitespace-nowrap border-b bg-transparent dark:bg-transparent dark:border-slate-600", data: { tabs_target: "tab", action: "click->tabs#change" } do %>
        <%%= icon "credit-card", classes: "w-5 h-5" %>
        <span>Billing</span>
      <%% end %>
      <%%= link_to "#", class: "py-3 px-4 flex items-center space-x-3 whitespace-nowrap border-b bg-transparent dark:bg-transparent dark:border-slate-600", data: { tabs_target: "tab", action: "click->tabs#change" } do %>
        <%%= icon "users", classes: "w-5 h-5" %>
        <span>Team</span>
      <%% end %>
    </nav>
  </div>
  <div class="p-4" data-tabs-target="panel">
    Some activities...
  </div>

  <div class="hidden p-4" data-tabs-target="panel">
    Account information...
  </div>

  <div class="hidden p-4" data-tabs-target="panel">
    Billing information...
  </div>
  <div class="hidden p-4" data-tabs-target="panel">
    Team information...
  </div>
</div>
<% end %>

<% content_for :haml, flush: true do %>
%div(data-controller="tabs" data-tabs-active-tab="py-3 px-4 border-b border-primary-500 flex items-center space-x-3 whitespace-nowrap text-primary-600 dark:text-primary-400 dark:border-primary-400 rounded-t" data-tabs-inactive-tab="py-3 px-4 flex items-center space-x-3 whitespace-nowrap border-b dark:border-slate-600")
  .border-slate-200.border-b.text-slate-600.dark:text-slate-200.dark:border-slate-600.text-sm.font-medium
    %nav.-mb-px.flex.items-center.flex-wrap(role="navigation")
      = link_to "#", class: "py-3 px-4 border-b border-primary-500 flex items-center space-x-3 whitespace-nowrap text-primary-600 dark:text-primary-400 dark:border-primary-400 rounded-t", data: { tabs_target: "tab", action: "click->tabs#change" } do
        = icon "chat-bubble-oval-left-ellipsis", classes: "w-5 h-5"
        %span Activity
      = link_to "#", class: "py-3 px-4 flex items-center space-x-3 whitespace-nowrap border-b bg-transparent dark:bg-transparent dark:border-slate-600", data: { tabs_target: "tab", action: "click->tabs#change" } do
        = icon "user-circle", classes: "w-5 h-5"
        %span Account
      = link_to "#", class: "py-3 px-4 flex items-center space-x-3 whitespace-nowrap border-b bg-transparent dark:bg-transparent dark:border-slate-600", data: { tabs_target: "tab", action: "click->tabs#change" } do
        = icon "credit-card", classes: "w-5 h-5"
        %span Billing
      = link_to "#", class: "py-3 px-4 flex items-center space-x-3 whitespace-nowrap border-b bg-transparent dark:bg-transparent dark:border-slate-600", data: { tabs_target: "tab", action: "click->tabs#change" } do
        = icon "users", classes: "w-5 h-5"
        %span Team
  .p-4(data-tabs-target="panel")
    Some activities...
  .hidden.p-4(data-tabs-target="panel")
    Account information...
  .hidden.p-4(data-tabs-target="panel")
    Billing information...
  .hidden.p-4(data-tabs-target="panel")
    Team information...
<% end %>

<% content_for :js, flush: true do %>
// Credits to @excid3 and crew
// https://github.com/excid3/tailwindcss-stimulus-components/graphs/contributors

import { Controller } from '@hotwired/stimulus'

export default class extends Controller {
  static targets = ['tab', 'panel']

  connect() {
    this.activeTabClasses = (this.data.get('activeTab') || 'active').split(' ')
    this.inactiveTabClasses = (this.data.get('inactiveTab') || 'inactive').split(' ')
    if (this.anchor) this.index = this.tabTargets.findIndex((tab) => tab.id === this.anchor)
    this.showTab()
  }

  change(event) {
    event.preventDefault()

    // If target specifies an index, use that
    if (event.currentTarget.dataset.index) {
      this.index = event.currentTarget.dataset.index

      // If target specifies an id, use that
    } else if (event.currentTarget.dataset.id) {
      this.index = this.tabTargets.findIndex((tab) => tab.id == event.currentTarget.dataset.id)

      // Otherwise, use the index of the current target
    } else {
      this.index = this.tabTargets.indexOf(event.currentTarget)
    }

    window.dispatchEvent(new CustomEvent('tsc:tab-change'))
  }

  showTab() {
    this.tabTargets.forEach((tab, index) => {
      const panel = this.panelTargets[index]

      if (index === this.index) {
        panel.classList.remove('hidden')
        tab.classList.remove(...this.inactiveTabClasses)
        tab.classList.add(...this.activeTabClasses)

        // Update URL with the tab ID if it has one
        // This will be automatically selected on page load
        if (tab.id) {
          location.hash = tab.id
        }
      } else {
        panel.classList.add('hidden')
        tab.classList.remove(...this.activeTabClasses)
        tab.classList.add(...this.inactiveTabClasses)
      }
    })
  }

  get index() {
    return parseInt(this.data.get('index') || 0)
  }

  set index(value) {
    this.data.set('index', (value >= 0 ? value : 0))
    this.showTab()
  }

  get anchor() {
    return (document.URL.split('#').length > 1) ? document.URL.split('#')[1] : null;
  }
}

<% end %>
<%= render_snippet html_filename: "tabs.html", erb_filename: "_tabs.html.erb", haml_filename: "_tabs.html.haml", js_filename: "tabs_controller.js" %>
<% end %>
<% end %>
</div>
